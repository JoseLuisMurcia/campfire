FROM maven:3.6.0-jdk-11-slim AS maven_build
WORKDIR /campfire

COPY pom.xml .
RUN mvn clean package -Dmaven.main.skip -Dmaven.test.skip && rm -r target

COPY src ./src
RUN mvn clean package -Dmaven.test.skip


FROM openjdk:11-jre-slim
COPY --from=maven_build /campfire/target/*.jar campfire.jar
CMD java -jar campfire.jar
